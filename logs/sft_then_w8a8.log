============================================================
SFT â†’ W8A8 Pipeline
  Stage: post_sft
  Force: False
  Log: /home/sunwoo/quant/0208/logs/sft_then_w8a8.log
============================================================

############################################################
# Stage 3: Post-SFT on existing W8A8
############################################################

============================================================
[Post-SFT] Training norms/embeddings on /home/sunwoo/quant/0208/models/w8a8_cal2048_d02
============================================================
`torch_dtype` is deprecated! Use `dtype` instead!
Compressing model: 0it [00:00, ?it/s]Compressing model: 202it [00:00, 2017.80it/s]Compressing model: 210it [00:00, 1999.34it/s]
[Post-SFT] Trainable: 209,843,968 / 1,279,852,288 (16.4%)
Adding EOS to train dataset:   0%|          | 0/3000 [00:00<?, ? examples/s]Adding EOS to train dataset: 100%|##########| 3000/3000 [00:00<00:00, 67485.34 examples/s]
Tokenizing train dataset:   0%|          | 0/3000 [00:00<?, ? examples/s]Tokenizing train dataset:   4%|3         | 109/3000 [00:00<00:02, 1069.23 examples/s]Tokenizing train dataset:   9%|8         | 263/3000 [00:00<00:02, 1037.36 examples/s]Tokenizing train dataset:  13%|#2        | 376/3000 [00:00<00:02, 1063.70 examples/s]Tokenizing train dataset:  16%|#6        | 487/3000 [00:00<00:02, 1075.08 examples/s]Tokenizing train dataset:  21%|##1       | 641/3000 [00:00<00:02, 1049.91 examples/s]Tokenizing train dataset:  27%|##6       | 800/3000 [00:00<00:02, 1051.40 examples/s]Tokenizing train dataset:  32%|###2      | 963/3000 [00:00<00:01, 1059.58 examples/s]Tokenizing train dataset:  37%|###6      | 1108/3000 [00:01<00:01, 960.27 examples/s]Tokenizing train dataset:  40%|####      | 1211/3000 [00:01<00:01, 974.78 examples/s]Tokenizing train dataset:  45%|####5     | 1364/3000 [00:01<00:01, 987.82 examples/s]Tokenizing train dataset:  50%|#####     | 1511/3000 [00:01<00:01, 983.32 examples/s]Tokenizing train dataset:  54%|#####3    | 1615/3000 [00:01<00:01, 992.48 examples/s]Tokenizing train dataset:  57%|#####7    | 1723/3000 [00:01<00:01, 1012.40 examples/s]Tokenizing train dataset:  61%|######    | 1829/3000 [00:01<00:01, 1023.97 examples/s]Tokenizing train dataset:  66%|######6   | 1980/3000 [00:01<00:01, 1012.50 examples/s]Tokenizing train dataset:  70%|######9   | 2098/3000 [00:02<00:00, 902.32 examples/s] Tokenizing train dataset:  73%|#######3  | 2204/3000 [00:02<00:00, 937.32 examples/s]Tokenizing train dataset:  77%|#######7  | 2310/3000 [00:02<00:00, 964.68 examples/s]Tokenizing train dataset:  81%|########  | 2416/3000 [00:02<00:00, 986.73 examples/s]Tokenizing train dataset:  84%|########4 | 2523/3000 [00:02<00:00, 1007.33 examples/s]Tokenizing train dataset:  88%|########7 | 2626/3000 [00:02<00:00, 1012.27 examples/s]Tokenizing train dataset:  91%|######### | 2729/3000 [00:02<00:00, 1016.40 examples/s]Tokenizing train dataset:  95%|#########4| 2839/3000 [00:02<00:00, 1038.10 examples/s]Tokenizing train dataset:  98%|#########8| 2950/3000 [00:02<00:00, 1055.66 examples/s]Tokenizing train dataset: 100%|##########| 3000/3000 [00:03<00:00, 992.53 examples/s] 
Truncating train dataset:   0%|          | 0/3000 [00:00<?, ? examples/s]Truncating train dataset: 100%|##########| 3000/3000 [00:00<00:00, 260764.12 examples/s]
The model is already on multiple devices. Skipping the move to device specified in `args`.
[Post-SFT] Starting training (norms + embeddings)...
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'pad_token_id': 361}.
  0%|          | 0/376 [00:00<?, ?it/s]  0%|          | 1/376 [00:02<14:37,  2.34s/it]  1%|          | 2/376 [00:04<13:40,  2.19s/it]  1%|          | 3/376 [00:06<13:43,  2.21s/it]  1%|1         | 4/376 [00:08<13:22,  2.16s/it]  1%|1         | 5/376 [00:10<13:15,  2.14s/it]  2%|1         | 6/376 [00:12<13:07,  2.13s/it]  2%|1         | 7/376 [00:15<13:20,  2.17s/it]  2%|2         | 8/376 [00:17<13:18,  2.17s/it]  2%|2         | 9/376 [00:19<13:12,  2.16s/it]  3%|2         | 10/376 [00:21<13:17,  2.18s/it]  3%|2         | 11/376 [00:23<13:07,  2.16s/it]  3%|3         | 12/376 [00:25<13:02,  2.15s/it]  3%|3         | 13/376 [00:28<12:51,  2.13s/it]  4%|3         | 14/376 [00:30<12:48,  2.12s/it]  4%|3         | 15/376 [00:32<12:48,  2.13s/it]  4%|4         | 16/376 [00:34<12:44,  2.12s/it]  5%|4         | 17/376 [00:36<12:33,  2.10s/it]  5%|4         | 18/376 [00:38<12:30,  2.10s/it]  5%|5         | 19/376 [00:40<12:41,  2.13s/it]  5%|5         | 20/376 [00:42<12:43,  2.14s/it]                                                {'loss': 1.4818, 'grad_norm': 0.734375, 'learning_rate': 1e-05, 'entropy': 1.1255409246310593, 'num_tokens': 255032.0, 'mean_token_accuracy': 0.6692392699420452, 'epoch': 0.11}
  5%|5         | 20/376 [00:42<12:43,  2.14s/it]  6%|5         | 21/376 [00:45<12:35,  2.13s/it]  6%|5         | 22/376 [00:47<12:40,  2.15s/it]  6%|6         | 23/376 [00:49<12:36,  2.14s/it]  6%|6         | 24/376 [00:51<12:33,  2.14s/it]  7%|6         | 25/376 [00:53<12:28,  2.13s/it]  7%|6         | 26/376 [00:55<12:34,  2.16s/it]  7%|7         | 27/376 [00:57<12:20,  2.12s/it]  7%|7         | 28/376 [00:59<12:18,  2.12s/it]  8%|7         | 29/376 [01:02<12:23,  2.14s/it]  8%|7         | 30/376 [01:04<12:18,  2.13s/it]  8%|8         | 31/376 [01:06<12:16,  2.13s/it]  9%|8         | 32/376 [01:08<12:23,  2.16s/it]  9%|8         | 33/376 [01:10<12:15,  2.14s/it]  9%|9         | 34/376 [01:12<12:11,  2.14s/it]  9%|9         | 35/376 [01:15<12:16,  2.16s/it] 10%|9         | 36/376 [01:17<12:10,  2.15s/it] 10%|9         | 37/376 [01:19<12:04,  2.14s/it] 10%|#         | 38/376 [01:21<12:09,  2.16s/it] 10%|#         | 39/376 [01:23<11:59,  2.14s/it] 11%|#         | 40/376 [01:25<11:48,  2.11s/it]                                                {'loss': 1.4941, 'grad_norm': 0.75390625, 'learning_rate': 1.9999568050254373e-05, 'entropy': 1.1336037032306194, 'num_tokens': 511797.0, 'mean_token_accuracy': 0.6680534832179547, 'epoch': 0.21}
 11%|#         | 40/376 [01:25<11:48,  2.11s/it] 11%|#         | 41/376 [01:27<11:59,  2.15s/it] 11%|#1        | 42/376 [01:29<11:50,  2.13s/it] 11%|#1        | 43/376 [01:32<11:49,  2.13s/it] 12%|#1        | 44/376 [01:34<11:58,  2.16s/it] 12%|#1        | 45/376 [01:36<11:51,  2.15s/it] 12%|#2        | 46/376 [01:38<11:44,  2.14s/it] 12%|#2        | 47/376 [01:40<11:34,  2.11s/it] 13%|#2        | 48/376 [01:42<11:43,  2.15s/it] 13%|#3        | 49/376 [01:44<11:37,  2.13s/it] 13%|#3        | 50/376 [01:47<11:32,  2.12s/it] 14%|#3        | 51/376 [01:49<11:32,  2.13s/it] 14%|#3        | 52/376 [01:51<11:32,  2.14s/it] 14%|#4        | 53/376 [01:53<11:30,  2.14s/it] 14%|#4        | 54/376 [01:55<11:33,  2.16s/it] 15%|#4        | 55/376 [01:57<11:26,  2.14s/it] 15%|#4        | 56/376 [01:59<11:25,  2.14s/it] 15%|#5        | 57/376 [02:02<11:29,  2.16s/it] 15%|#5        | 58/376 [02:04<11:24,  2.15s/it] 16%|#5        | 59/376 [02:06<11:20,  2.15s/it] 16%|#5        | 60/376 [02:08<11:21,  2.16s/it]                                                {'loss': 1.4943, 'grad_norm': 0.671875, 'learning_rate': 1.9810112804959867e-05, 'entropy': 1.124651838093996, 'num_tokens': 766579.0, 'mean_token_accuracy': 0.6665192425251008, 'epoch': 0.32}
 16%|#5        | 60/376 [02:08<11:21,  2.16s/it] 16%|#6        | 61/376 [02:10<11:10,  2.13s/it] 16%|#6        | 62/376 [02:12<11:12,  2.14s/it] 17%|#6        | 63/376 [02:15<11:16,  2.16s/it] 17%|#7        | 64/376 [02:17<11:12,  2.16s/it] 17%|#7        | 65/376 [02:19<11:04,  2.14s/it] 18%|#7        | 66/376 [02:21<11:08,  2.16s/it] 18%|#7        | 67/376 [02:23<11:07,  2.16s/it] 18%|#8        | 68/376 [02:25<10:59,  2.14s/it] 18%|#8        | 69/376 [02:27<11:04,  2.16s/it] 19%|#8        | 70/376 [02:30<10:51,  2.13s/it] 19%|#8        | 71/376 [02:32<10:45,  2.12s/it] 19%|#9        | 72/376 [02:34<10:42,  2.11s/it] 19%|#9        | 73/376 [02:36<10:48,  2.14s/it] 20%|#9        | 74/376 [02:38<10:46,  2.14s/it] 20%|#9        | 75/376 [02:40<10:43,  2.14s/it] 20%|##        | 76/376 [02:42<10:45,  2.15s/it] 20%|##        | 77/376 [02:45<10:44,  2.15s/it] 21%|##        | 78/376 [02:47<10:48,  2.18s/it] 21%|##1       | 79/376 [02:49<10:38,  2.15s/it] 21%|##1       | 80/376 [02:51<10:30,  2.13s/it]                                                {'loss': 1.4447, 'grad_norm': 0.7734375, 'learning_rate': 1.9282632151787462e-05, 'entropy': 1.122907316684723, 'num_tokens': 1024748.0, 'mean_token_accuracy': 0.6726527731865645, 'epoch': 0.43}
 21%|##1       | 80/376 [02:51<10:30,  2.13s/it] 22%|##1       | 81/376 [02:53<10:29,  2.14s/it] 22%|##1       | 82/376 [02:55<10:24,  2.12s/it] 22%|##2       | 83/376 [02:57<10:21,  2.12s/it] 22%|##2       | 84/376 [02:59<10:11,  2.09s/it] 23%|##2       | 85/376 [03:02<10:22,  2.14s/it] 23%|##2       | 86/376 [03:04<10:21,  2.14s/it] 23%|##3       | 87/376 [03:06<10:19,  2.14s/it] 23%|##3       | 88/376 [03:08<10:27,  2.18s/it] 24%|##3       | 89/376 [03:10<10:17,  2.15s/it] 24%|##3       | 90/376 [03:12<10:12,  2.14s/it] 24%|##4       | 91/376 [03:15<10:15,  2.16s/it] 24%|##4       | 92/376 [03:17<10:06,  2.14s/it] 25%|##4       | 93/376 [03:19<09:55,  2.10s/it] 25%|##5       | 94/376 [03:21<10:00,  2.13s/it] 25%|##5       | 95/376 [03:23<09:48,  2.09s/it] 26%|##5       | 96/376 [03:25<09:48,  2.10s/it] 26%|##5       | 97/376 [03:27<09:57,  2.14s/it] 26%|##6       | 98/376 [03:29<09:55,  2.14s/it] 26%|##6       | 99/376 [03:31<09:53,  2.14s/it] 27%|##6       | 100/376 [03:34<09:46,  2.12s/it]                                                 {'loss': 1.4723, 'grad_norm': 0.671875, 'learning_rate': 1.843530140293603e-05, 'entropy': 1.1326587922871112, 'num_tokens': 1275763.0, 'mean_token_accuracy': 0.6695375639945269, 'epoch': 0.53}
 27%|##6       | 100/376 [03:34<09:46,  2.12s/it] 27%|##6       | 101/376 [03:36<09:52,  2.15s/it] 27%|##7       | 102/376 [03:38<09:47,  2.15s/it] 27%|##7       | 103/376 [03:40<09:44,  2.14s/it] 28%|##7       | 104/376 [03:42<09:52,  2.18s/it] 28%|##7       | 105/376 [03:44<09:48,  2.17s/it] 28%|##8       | 106/376 [03:47<09:40,  2.15s/it] 28%|##8       | 107/376 [03:49<09:43,  2.17s/it] 29%|##8       | 108/376 [03:51<09:37,  2.16s/it] 29%|##8       | 109/376 [03:53<09:26,  2.12s/it] 29%|##9       | 110/376 [03:55<09:29,  2.14s/it] 30%|##9       | 111/376 [03:57<09:25,  2.13s/it] 30%|##9       | 112/376 [03:59<09:16,  2.11s/it] 30%|###       | 113/376 [04:02<09:24,  2.15s/it] 30%|###       | 114/376 [04:04<09:14,  2.12s/it] 31%|###       | 115/376 [04:06<09:13,  2.12s/it] 31%|###       | 116/376 [04:08<09:13,  2.13s/it] 31%|###1      | 117/376 [04:10<09:09,  2.12s/it] 31%|###1      | 118/376 [04:12<09:03,  2.11s/it] 32%|###1      | 119/376 [04:14<09:02,  2.11s/it] 32%|###1      | 120/376 [04:16<08:57,  2.10s/it]                                                 {'loss': 1.4773, 'grad_norm': 0.6640625, 'learning_rate': 1.729731689158568e-05, 'entropy': 1.1417721305042505, 'num_tokens': 1525074.0, 'mean_token_accuracy': 0.6674849670380354, 'epoch': 0.64}
 32%|###1      | 120/376 [04:16<08:57,  2.10s/it] 32%|###2      | 121/376 [04:18<08:53,  2.09s/it] 32%|###2      | 122/376 [04:20<08:49,  2.08s/it] 33%|###2      | 123/376 [04:23<08:59,  2.13s/it] 33%|###2      | 124/376 [04:25<08:55,  2.12s/it] 33%|###3      | 125/376 [04:27<08:50,  2.11s/it] 34%|###3      | 126/376 [04:29<08:55,  2.14s/it] 34%|###3      | 127/376 [04:31<08:53,  2.14s/it] 34%|###4      | 128/376 [04:33<08:48,  2.13s/it] 34%|###4      | 129/376 [04:35<08:52,  2.15s/it] 35%|###4      | 130/376 [04:38<08:43,  2.13s/it] 35%|###4      | 131/376 [04:40<08:39,  2.12s/it] 35%|###5      | 132/376 [04:42<08:46,  2.16s/it] 35%|###5      | 133/376 [04:44<08:33,  2.11s/it] 36%|###5      | 134/376 [04:46<08:32,  2.12s/it] 36%|###5      | 135/376 [04:48<08:37,  2.15s/it] 36%|###6      | 136/376 [04:50<08:26,  2.11s/it] 36%|###6      | 137/376 [04:52<08:18,  2.09s/it] 37%|###6      | 138/376 [04:54<08:22,  2.11s/it] 37%|###6      | 139/376 [04:57<08:16,  2.09s/it] 37%|###7      | 140/376 [04:59<08:11,  2.08s/it]                                                 {'loss': 1.4838, 'grad_norm': 0.7109375, 'learning_rate': 1.5907889958753134e-05, 'entropy': 1.1642982902005314, 'num_tokens': 1771884.0, 'mean_token_accuracy': 0.6645602095872164, 'epoch': 0.75}
 37%|###7      | 140/376 [04:59<08:11,  2.08s/it] 38%|###7      | 141/376 [05:01<08:14,  2.11s/it] 38%|###7      | 142/376 [05:03<08:14,  2.11s/it] 38%|###8      | 143/376 [05:05<08:15,  2.13s/it] 38%|###8      | 144/376 [05:07<08:12,  2.12s/it] 39%|###8      | 145/376 [05:09<08:10,  2.12s/it] 39%|###8      | 146/376 [05:11<08:07,  2.12s/it] 39%|###9      | 147/376 [05:13<08:01,  2.10s/it] 39%|###9      | 148/376 [05:16<07:59,  2.10s/it] 40%|###9      | 149/376 [05:18<07:59,  2.11s/it] 40%|###9      | 150/376 [05:20<07:58,  2.12s/it] 40%|####      | 151/376 [05:22<08:01,  2.14s/it] 40%|####      | 152/376 [05:24<07:57,  2.13s/it] 41%|####      | 153/376 [05:26<07:57,  2.14s/it] 41%|####      | 154/376 [05:28<07:54,  2.14s/it] 41%|####1     | 155/376 [05:30<07:47,  2.11s/it] 41%|####1     | 156/376 [05:32<07:41,  2.10s/it] 42%|####1     | 157/376 [05:35<07:44,  2.12s/it] 42%|####2     | 158/376 [05:37<07:40,  2.11s/it] 42%|####2     | 159/376 [05:39<07:33,  2.09s/it] 43%|####2     | 160/376 [05:41<07:39,  2.13s/it]                                                 {'loss': 1.4669, 'grad_norm': 0.640625, 'learning_rate': 1.4314895854705641e-05, 'entropy': 1.1369812360033393, 'num_tokens': 2020174.0, 'mean_token_accuracy': 0.6710194878280162, 'epoch': 0.85}
 43%|####2     | 160/376 [05:41<07:39,  2.13s/it] 43%|####2     | 161/376 [05:43<07:34,  2.12s/it] 43%|####3     | 162/376 [05:45<07:34,  2.12s/it] 43%|####3     | 163/376 [05:47<07:37,  2.15s/it] 44%|####3     | 164/376 [05:50<07:34,  2.14s/it] 44%|####3     | 165/376 [05:52<07:32,  2.14s/it] 44%|####4     | 166/376 [05:54<07:29,  2.14s/it] 44%|####4     | 167/376 [05:56<07:24,  2.13s/it] 45%|####4     | 168/376 [05:58<07:16,  2.10s/it] 45%|####4     | 169/376 [06:00<07:21,  2.13s/it] 45%|####5     | 170/376 [06:02<07:15,  2.11s/it] 45%|####5     | 171/376 [06:04<07:15,  2.13s/it] 46%|####5     | 172/376 [06:07<07:16,  2.14s/it] 46%|####6     | 173/376 [06:09<07:09,  2.11s/it] 46%|####6     | 174/376 [06:11<07:06,  2.11s/it] 47%|####6     | 175/376 [06:13<07:03,  2.11s/it] 47%|####6     | 176/376 [06:15<07:06,  2.13s/it] 47%|####7     | 177/376 [06:17<07:04,  2.13s/it] 47%|####7     | 178/376 [06:19<07:02,  2.13s/it] 48%|####7     | 179/376 [06:22<07:05,  2.16s/it] 48%|####7     | 180/376 [06:24<07:04,  2.16s/it]                                                 {'loss': 1.5072, 'grad_norm': 0.671875, 'learning_rate': 1.2573224109510112e-05, 'entropy': 1.1911597386002541, 'num_tokens': 2271972.0, 'mean_token_accuracy': 0.6602907899767161, 'epoch': 0.96}
 48%|####7     | 180/376 [06:24<07:04,  2.16s/it] 48%|####8     | 181/376 [06:26<06:56,  2.14s/it] 48%|####8     | 182/376 [06:28<06:53,  2.13s/it] 49%|####8     | 183/376 [06:30<06:48,  2.12s/it] 49%|####8     | 184/376 [06:32<06:45,  2.11s/it] 49%|####9     | 185/376 [06:34<06:48,  2.14s/it] 49%|####9     | 186/376 [06:36<06:42,  2.12s/it] 50%|####9     | 187/376 [06:38<06:40,  2.12s/it] 50%|#####     | 188/376 [06:40<05:38,  1.80s/it] 50%|#####     | 189/376 [06:42<06:00,  1.93s/it] 51%|#####     | 190/376 [06:44<06:09,  1.99s/it] 51%|#####     | 191/376 [06:46<06:20,  2.06s/it] 51%|#####1    | 192/376 [06:48<06:17,  2.05s/it] 51%|#####1    | 193/376 [06:50<06:20,  2.08s/it] 52%|#####1    | 194/376 [06:52<06:21,  2.10s/it] 52%|#####1    | 195/376 [06:55<06:26,  2.13s/it] 52%|#####2    | 196/376 [06:57<06:22,  2.13s/it] 52%|#####2    | 197/376 [06:59<06:19,  2.12s/it] 53%|#####2    | 198/376 [07:01<06:17,  2.12s/it] 53%|#####2    | 199/376 [07:03<06:13,  2.11s/it] 53%|#####3    | 200/376 [07:05<06:14,  2.13s/it]                                                 {'loss': 1.4376, 'grad_norm': 0.65234375, 'learning_rate': 1.0742887213722372e-05, 'entropy': 1.1157743139908864, 'num_tokens': 2517584.0, 'mean_token_accuracy': 0.6749755743986521, 'epoch': 1.06}
 53%|#####3    | 200/376 [07:05<06:14,  2.13s/it] 53%|#####3    | 201/376 [07:07<06:15,  2.15s/it] 54%|#####3    | 202/376 [07:10<06:12,  2.14s/it] 54%|#####3    | 203/376 [07:12<06:09,  2.13s/it] 54%|#####4    | 204/376 [07:14<06:07,  2.14s/it] 55%|#####4    | 205/376 [07:16<06:05,  2.14s/it] 55%|#####4    | 206/376 [07:18<06:01,  2.13s/it] 55%|#####5    | 207/376 [07:20<06:03,  2.15s/it] 55%|#####5    | 208/376 [07:22<05:58,  2.14s/it] 56%|#####5    | 209/376 [07:25<05:57,  2.14s/it] 56%|#####5    | 210/376 [07:27<05:57,  2.16s/it] 56%|#####6    | 211/376 [07:29<05:54,  2.15s/it] 56%|#####6    | 212/376 [07:31<05:49,  2.13s/it] 57%|#####6    | 213/376 [07:33<05:44,  2.12s/it] 57%|#####6    | 214/376 [07:35<05:47,  2.15s/it] 57%|#####7    | 215/376 [07:37<05:43,  2.13s/it] 57%|#####7    | 216/376 [07:39<05:40,  2.13s/it] 58%|#####7    | 217/376 [07:42<05:41,  2.15s/it] 58%|#####7    | 218/376 [07:44<05:38,  2.14s/it] 58%|#####8    | 219/376 [07:46<05:36,  2.14s/it] 59%|#####8    | 220/376 [07:48<05:38,  2.17s/it]                                                 {'loss': 1.4335, 'grad_norm': 0.7265625, 'learning_rate': 8.88695277808791e-06, 'entropy': 1.1360822703689337, 'num_tokens': 2769609.0, 'mean_token_accuracy': 0.6737868558615446, 'epoch': 1.17}
 59%|#####8    | 220/376 [07:48<05:38,  2.17s/it] 59%|#####8    | 221/376 [07:50<05:34,  2.16s/it] 59%|#####9    | 222/376 [07:52<05:31,  2.15s/it] 59%|#####9    | 223/376 [07:55<05:33,  2.18s/it] 60%|#####9    | 224/376 [07:57<05:23,  2.13s/it] 60%|#####9    | 225/376 [07:59<05:20,  2.13s/it] 60%|######    | 226/376 [08:01<05:21,  2.15s/it] 60%|######    | 227/376 [08:03<05:14,  2.11s/it] 61%|######    | 228/376 [08:05<05:11,  2.10s/it] 61%|######    | 229/376 [08:07<05:15,  2.15s/it] 61%|######1   | 230/376 [08:09<05:11,  2.13s/it] 61%|######1   | 231/376 [08:12<05:06,  2.12s/it] 62%|######1   | 232/376 [08:14<05:07,  2.14s/it] 62%|######1   | 233/376 [08:16<05:04,  2.13s/it] 62%|######2   | 234/376 [08:18<05:01,  2.13s/it] 62%|######2   | 235/376 [08:20<04:58,  2.12s/it] 63%|######2   | 236/376 [08:22<04:58,  2.14s/it] 63%|######3   | 237/376 [08:24<04:54,  2.12s/it] 63%|######3   | 238/376 [08:26<04:54,  2.13s/it] 64%|######3   | 239/376 [08:29<04:48,  2.11s/it] 64%|######3   | 240/376 [08:31<04:48,  2.12s/it]                                                 {'loss': 1.4871, 'grad_norm': 0.62109375, 'learning_rate': 7.06937042347987e-06, 'entropy': 1.1799797298386694, 'num_tokens': 3021000.0, 'mean_token_accuracy': 0.6651275586336851, 'epoch': 1.28}
 64%|######3   | 240/376 [08:31<04:48,  2.12s/it] 64%|######4   | 241/376 [08:33<04:45,  2.11s/it] 64%|######4   | 242/376 [08:35<04:44,  2.13s/it] 65%|######4   | 243/376 [08:37<04:43,  2.13s/it] 65%|######4   | 244/376 [08:39<04:39,  2.12s/it] 65%|######5   | 245/376 [08:41<04:42,  2.15s/it] 65%|######5   | 246/376 [08:44<04:39,  2.15s/it] 66%|######5   | 247/376 [08:46<04:38,  2.16s/it] 66%|######5   | 248/376 [08:48<04:38,  2.18s/it] 66%|######6   | 249/376 [08:50<04:35,  2.17s/it] 66%|######6   | 250/376 [08:52<04:31,  2.15s/it] 67%|######6   | 251/376 [08:54<04:32,  2.18s/it] 67%|######7   | 252/376 [08:57<04:29,  2.17s/it] 67%|######7   | 253/376 [08:59<04:24,  2.15s/it] 68%|######7   | 254/376 [09:01<04:22,  2.16s/it] 68%|######7   | 255/376 [09:03<04:17,  2.13s/it] 68%|######8   | 256/376 [09:05<04:11,  2.10s/it] 68%|######8   | 257/376 [09:07<04:12,  2.12s/it] 69%|######8   | 258/376 [09:09<04:08,  2.11s/it] 69%|######8   | 259/376 [09:11<04:07,  2.11s/it] 69%|######9   | 260/376 [09:13<04:04,  2.10s/it]                                                 {'loss': 1.4785, 'grad_norm': 0.7578125, 'learning_rate': 5.352768279562315e-06, 'entropy': 1.1810316160321235, 'num_tokens': 3272559.0, 'mean_token_accuracy': 0.665228433534503, 'epoch': 1.38}
 69%|######9   | 260/376 [09:13<04:04,  2.10s/it] 69%|######9   | 261/376 [09:16<04:04,  2.13s/it] 70%|######9   | 262/376 [09:18<03:59,  2.10s/it] 70%|######9   | 263/376 [09:20<03:57,  2.10s/it] 70%|#######   | 264/376 [09:22<03:57,  2.12s/it] 70%|#######   | 265/376 [09:24<03:54,  2.11s/it] 71%|#######   | 266/376 [09:26<03:53,  2.12s/it] 71%|#######1  | 267/376 [09:28<03:51,  2.13s/it] 71%|#######1  | 268/376 [09:30<03:50,  2.13s/it] 72%|#######1  | 269/376 [09:32<03:44,  2.10s/it] 72%|#######1  | 270/376 [09:35<03:47,  2.14s/it] 72%|#######2  | 271/376 [09:37<03:44,  2.14s/it] 72%|#######2  | 272/376 [09:39<03:42,  2.14s/it] 73%|#######2  | 273/376 [09:41<03:42,  2.16s/it] 73%|#######2  | 274/376 [09:43<03:38,  2.14s/it] 73%|#######3  | 275/376 [09:45<03:36,  2.14s/it] 73%|#######3  | 276/376 [09:48<03:35,  2.16s/it] 74%|#######3  | 277/376 [09:50<03:32,  2.14s/it] 74%|#######3  | 278/376 [09:52<03:27,  2.12s/it] 74%|#######4  | 279/376 [09:54<03:27,  2.14s/it] 74%|#######4  | 280/376 [09:56<03:24,  2.13s/it]                                                 {'loss': 1.4593, 'grad_norm': 0.67578125, 'learning_rate': 3.7962950178539282e-06, 'entropy': 1.178963815793395, 'num_tokens': 3520984.0, 'mean_token_accuracy': 0.6676713641732931, 'epoch': 1.49}
 74%|#######4  | 280/376 [09:56<03:24,  2.13s/it] 75%|#######4  | 281/376 [09:58<03:19,  2.10s/it] 75%|#######5  | 282/376 [10:00<03:18,  2.11s/it] 75%|#######5  | 283/376 [10:02<03:15,  2.11s/it] 76%|#######5  | 284/376 [10:04<03:14,  2.11s/it] 76%|#######5  | 285/376 [10:07<03:14,  2.14s/it] 76%|#######6  | 286/376 [10:09<03:11,  2.13s/it] 76%|#######6  | 287/376 [10:11<03:08,  2.11s/it] 77%|#######6  | 288/376 [10:13<03:06,  2.12s/it] 77%|#######6  | 289/376 [10:15<03:07,  2.15s/it] 77%|#######7  | 290/376 [10:17<03:02,  2.12s/it] 77%|#######7  | 291/376 [10:19<02:59,  2.11s/it] 78%|#######7  | 292/376 [10:22<02:59,  2.14s/it] 78%|#######7  | 293/376 [10:24<02:56,  2.13s/it] 78%|#######8  | 294/376 [10:26<02:52,  2.11s/it] 78%|#######8  | 295/376 [10:28<02:52,  2.13s/it] 79%|#######8  | 296/376 [10:30<02:49,  2.12s/it] 79%|#######8  | 297/376 [10:32<02:48,  2.13s/it] 79%|#######9  | 298/376 [10:34<02:48,  2.15s/it] 80%|#######9  | 299/376 [10:36<02:44,  2.14s/it] 80%|#######9  | 300/376 [10:39<02:41,  2.13s/it]                                                 {'loss': 1.4575, 'grad_norm': 0.65625, 'learning_rate': 2.4535817758961644e-06, 'entropy': 1.1736064601689578, 'num_tokens': 3773628.0, 'mean_token_accuracy': 0.6680374547839165, 'epoch': 1.6}
 80%|#######9  | 300/376 [10:39<02:41,  2.13s/it] 80%|########  | 301/376 [10:41<02:41,  2.15s/it] 80%|########  | 302/376 [10:43<02:37,  2.13s/it] 81%|########  | 303/376 [10:45<02:35,  2.12s/it] 81%|########  | 304/376 [10:47<02:34,  2.15s/it] 81%|########1 | 305/376 [10:49<02:32,  2.15s/it] 81%|########1 | 306/376 [10:51<02:29,  2.14s/it] 82%|########1 | 307/376 [10:54<02:28,  2.16s/it] 82%|########1 | 308/376 [10:56<02:25,  2.15s/it] 82%|########2 | 309/376 [10:58<02:23,  2.14s/it] 82%|########2 | 310/376 [11:00<02:19,  2.12s/it] 83%|########2 | 311/376 [11:02<02:19,  2.15s/it] 83%|########2 | 312/376 [11:04<02:15,  2.11s/it] 83%|########3 | 313/376 [11:06<02:13,  2.12s/it] 84%|########3 | 314/376 [11:09<02:12,  2.14s/it] 84%|########3 | 315/376 [11:11<02:08,  2.11s/it] 84%|########4 | 316/376 [11:13<02:05,  2.10s/it] 84%|########4 | 317/376 [11:15<02:05,  2.13s/it] 85%|########4 | 318/376 [11:17<02:04,  2.14s/it] 85%|########4 | 319/376 [11:19<02:01,  2.14s/it] 85%|########5 | 320/376 [11:21<02:01,  2.17s/it]                                                 {'loss': 1.4645, 'grad_norm': 0.61328125, 'learning_rate': 1.3708941981621814e-06, 'entropy': 1.162776105105877, 'num_tokens': 4031628.0, 'mean_token_accuracy': 0.6658149167895318, 'epoch': 1.7}
 85%|########5 | 320/376 [11:21<02:01,  2.17s/it] 85%|########5 | 321/376 [11:23<01:58,  2.15s/it] 86%|########5 | 322/376 [11:26<01:55,  2.14s/it] 86%|########5 | 323/376 [11:28<01:54,  2.15s/it] 86%|########6 | 324/376 [11:30<01:50,  2.13s/it] 86%|########6 | 325/376 [11:32<01:48,  2.12s/it] 87%|########6 | 326/376 [11:34<01:47,  2.15s/it] 87%|########6 | 327/376 [11:36<01:44,  2.14s/it] 87%|########7 | 328/376 [11:38<01:41,  2.11s/it] 88%|########7 | 329/376 [11:40<01:40,  2.13s/it] 88%|########7 | 330/376 [11:43<01:37,  2.13s/it] 88%|########8 | 331/376 [11:45<01:34,  2.10s/it] 88%|########8 | 332/376 [11:47<01:34,  2.14s/it] 89%|########8 | 333/376 [11:49<01:31,  2.14s/it] 89%|########8 | 334/376 [11:51<01:29,  2.14s/it] 89%|########9 | 335/376 [11:53<01:27,  2.13s/it] 89%|########9 | 336/376 [11:55<01:25,  2.14s/it] 90%|########9 | 337/376 [11:58<01:23,  2.14s/it] 90%|########9 | 338/376 [12:00<01:21,  2.15s/it] 90%|######### | 339/376 [12:02<01:18,  2.13s/it] 90%|######### | 340/376 [12:04<01:16,  2.12s/it]                                                 {'loss': 1.4878, 'grad_norm': 0.6640625, 'learning_rate': 5.85538268522301e-07, 'entropy': 1.1726985678076745, 'num_tokens': 4280318.0, 'mean_token_accuracy': 0.6645373608916998, 'epoch': 1.81}
 90%|######### | 340/376 [12:04<01:16,  2.12s/it] 91%|######### | 341/376 [12:06<01:15,  2.15s/it] 91%|######### | 342/376 [12:08<01:12,  2.14s/it] 91%|#########1| 343/376 [12:10<01:09,  2.12s/it] 91%|#########1| 344/376 [12:12<01:07,  2.11s/it] 92%|#########1| 345/376 [12:15<01:06,  2.14s/it] 92%|#########2| 346/376 [12:17<01:03,  2.12s/it] 92%|#########2| 347/376 [12:19<01:01,  2.14s/it] 93%|#########2| 348/376 [12:21<01:00,  2.17s/it] 93%|#########2| 349/376 [12:23<00:58,  2.16s/it] 93%|#########3| 350/376 [12:25<00:55,  2.14s/it] 93%|#########3| 351/376 [12:28<00:53,  2.15s/it] 94%|#########3| 352/376 [12:30<00:51,  2.13s/it] 94%|#########3| 353/376 [12:32<00:48,  2.11s/it] 94%|#########4| 354/376 [12:34<00:47,  2.14s/it] 94%|#########4| 355/376 [12:36<00:44,  2.13s/it] 95%|#########4| 356/376 [12:38<00:42,  2.13s/it] 95%|#########4| 357/376 [12:40<00:40,  2.14s/it] 95%|#########5| 358/376 [12:42<00:38,  2.13s/it] 95%|#########5| 359/376 [12:45<00:36,  2.13s/it] 96%|#########5| 360/376 [12:47<00:34,  2.15s/it]                                                 {'loss': 1.4205, 'grad_norm': 0.65234375, 'learning_rate': 1.245748642287814e-07, 'entropy': 1.1389360133558513, 'num_tokens': 4532461.0, 'mean_token_accuracy': 0.6746254537254572, 'epoch': 1.92}
 96%|#########5| 360/376 [12:47<00:34,  2.15s/it] 96%|#########6| 361/376 [12:49<00:32,  2.15s/it] 96%|#########6| 362/376 [12:51<00:29,  2.14s/it] 97%|#########6| 363/376 [12:53<00:27,  2.13s/it] 97%|#########6| 364/376 [12:55<00:25,  2.16s/it] 97%|#########7| 365/376 [12:57<00:23,  2.16s/it] 97%|#########7| 366/376 [13:00<00:21,  2.14s/it] 98%|#########7| 367/376 [13:02<00:19,  2.16s/it] 98%|#########7| 368/376 [13:04<00:16,  2.12s/it] 98%|#########8| 369/376 [13:06<00:14,  2.12s/it] 98%|#########8| 370/376 [13:08<00:12,  2.15s/it] 99%|#########8| 371/376 [13:10<00:10,  2.14s/it] 99%|#########8| 372/376 [13:12<00:08,  2.12s/it] 99%|#########9| 373/376 [13:15<00:06,  2.15s/it] 99%|#########9| 374/376 [13:17<00:04,  2.13s/it]100%|#########9| 375/376 [13:19<00:02,  2.13s/it]100%|##########| 376/376 [13:20<00:00,  1.81s/it]                                                 {'train_runtime': 800.3284, 'train_samples_per_second': 7.497, 'train_steps_per_second': 0.47, 'train_loss': 1.4683979775043243, 'entropy': 1.1451535893063391, 'num_tokens': 4730450.0, 'mean_token_accuracy': 0.675881982330353, 'epoch': 2.0}
100%|##########| 376/376 [13:20<00:00,  1.81s/it]100%|##########| 376/376 [13:20<00:00,  2.13s/it]
[Post-SFT] Done in 800s
[Post-SFT] Fixing compressed format...
[Fix] Updated 122 trained tensors in compressed model
[Post-SFT] Saved to /home/sunwoo/quant/0208/models/w8a8_postsft

[DONE] Pipeline complete. Log: /home/sunwoo/quant/0208/logs/sft_then_w8a8.log
